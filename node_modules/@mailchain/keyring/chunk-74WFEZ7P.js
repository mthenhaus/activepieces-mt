"use strict";Object.defineProperty(exports, "__esModule", {value: true});// src/functions.ts




var _crypto = require('@mailchain/crypto');
function ecdhKeyRingDecrypter(privateKey) {
  return {
    curve: privateKey.curve,
    sign: (input) => privateKey.sign(input),
    publicKey: privateKey.publicKey,
    ecdhDecrypt: async (bundleEphemeralKey, input) => {
      const keyEx = new (0, _crypto.ED25519KeyExchange)();
      const sharedSecret = await keyEx.SharedSecret(privateKey, bundleEphemeralKey);
      const decrypter = _crypto.PrivateKeyDecrypter.fromPrivateKey(_crypto.ED25519PrivateKey.fromSeed(sharedSecret));
      return decrypter.decrypt(input);
    }
  };
}



exports.ecdhKeyRingDecrypter = ecdhKeyRingDecrypter;
