import { ED25519ExtendedPrivateKey, RandomFunction, PrivateKey } from '@mailchain/crypto';
import { EncryptedPayload } from './payload.js';

/**
 * Encrypts a payload
 *
 * @param input
 * @param payloadRootKey is used to derive a separate key for the headers and each part of the message
 * @param chunkSize approx 1mb
 * @returns
 */
declare function encryptPayload(headers: Buffer, content: Buffer, payloadRootKey: ED25519ExtendedPrivateKey, chunkSize?: number, rand?: RandomFunction): Promise<EncryptedPayload>;
/**
 * Encrypts each chunk with a different key derived from payloadRootKey
 * @param chunks chunks of max 1mb to encrypt
 * @param payloadRootKey root key used to derive encryption keys for each chunk
 * @returns list of encrypted chunks
 */
declare function encryptChunks(chunks: Buffer[], payloadRootKey: ED25519ExtendedPrivateKey, rand?: RandomFunction): Promise<Buffer[]>;
declare function encryptBuffer(buffer: Buffer, key: PrivateKey, rand?: RandomFunction): Promise<Buffer>;

export { encryptBuffer, encryptChunks, encryptPayload };
