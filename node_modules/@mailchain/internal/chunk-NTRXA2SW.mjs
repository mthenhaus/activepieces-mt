// src/user/consolidateMailbox.ts
import { isSameAddress } from "@mailchain/addressing";
import uniqWith from "lodash/unionWith.js";
function consolidateMailbox(mailbox) {
  const consolidators = [consolidateMailboxLabel, consolidateMailboxAliases];
  return consolidators.reduce((prev, consolidator) => consolidator(prev), mailbox);
}
function consolidateMailboxLabel(mailbox) {
  return { ...mailbox, label: mailbox.label?.trim() || null };
}
function consolidateMailboxAliases(mailbox) {
  return {
    ...mailbox,
    aliases: uniqWith(mailbox.aliases, (a, b) => isSameAddress(a.address, b.address))
  };
}

export {
  consolidateMailbox,
  consolidateMailboxLabel,
  consolidateMailboxAliases
};
