import { KeyRing } from '@mailchain/keyring';
import { MailAddress } from '../transport/mail/types.js';
import { AddressIdentityKeyResolver } from './addressIdentityKeyResolver.js';
import '@mailchain/addressing';
import '@mailchain/crypto';
import '../identityKeys/identityKeys.js';
import '@mailchain/api';
import '../configuration.js';
import '../formatters/parse.js';

type AddressHash = {
    hash: Uint8Array;
    type: 'username' | 'identity-key';
};
type AddressesHasher = (addresses: string[]) => Promise<Map<string, AddressHash[]>>;
declare function mailchainAddressHasher(identityKeyResolver: AddressIdentityKeyResolver, keyRing: KeyRing): AddressesHasher;
/**
 * Get a single hash for the provided `address`
 *
 * @param hashMap the map containing all the hash for the address
 * @param address the address to get the hash for
 * @param types preference for the type of hash to get
 *
 * @throws Error if there is no hash of the desired type of the address
 */
declare function getAddressHash(hashMap: Map<string, AddressHash[]>, address: string, ...types: AddressHash['type'][]): AddressHash['hash'];
/**
 * Get all the hashes (of all types) for the provided `address`
 *
 * @param hashMap the map containing all the hash for the address
 * @param address the address to get the hashes for
 *
 * @throws Error if there is no hash for the address
 */
declare function getAddressHashes(hashMap: Map<string, AddressHash[]>, address: string): Uint8Array[];
/**
 * Get all the hashes (of all the types) for all the provided `addresses`
 *
 * @param hashMap the map containing all the hashes for the addresses
 * @param addresses the addresses to get the hashes for
 *
 * @throws Error if for any of the provided addresses there is no hash
 */
declare function getAddressesHashes(hashMap: Map<string, AddressHash[]>, addresses: string[]): Uint8Array[];
/** Just utility wrapper around {@link getAddressesHashes} to support {@link MailAddress} for addresses */
declare function getMailAddressesHashes(hashMap: Map<string, AddressHash[]>, addresses: MailAddress[]): Uint8Array[];

export { AddressHash, AddressesHasher, getAddressHash, getAddressHashes, getAddressesHashes, getMailAddressesHashes, mailchainAddressHasher };
