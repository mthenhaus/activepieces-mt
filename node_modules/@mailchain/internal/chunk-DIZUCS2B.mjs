import {
  MessagingKeys
} from "./chunk-NK6CIHSE.mjs";

// src/transport/verifier/sender.ts
import { isPublicKeyEqual } from "@mailchain/crypto";
var SenderVerifier = class {
  constructor(messagingKeys) {
    this.messagingKeys = messagingKeys;
  }
  static create(configuration) {
    return new SenderVerifier(MessagingKeys.create(configuration));
  }
  /**
   *
   * @param fromAddress address that sent the mail. `From:` header in the mail.
   * @param senderMessagingKey public key of the sender.
   * @param at Date to resolve the sender messaging key. When no date is provided, the address resolves using the latest block.
   * @returns
   */
  async verifySenderOwnsFromAddress(fromAddress, senderMessagingKey, at) {
    const { data: resolvedSenderMessagingKey, error } = await this.messagingKeys.resolve(fromAddress, at);
    if (error != null) {
      return false;
    }
    return isPublicKeyEqual(resolvedSenderMessagingKey.messagingKey, senderMessagingKey);
  }
};

export {
  SenderVerifier
};
