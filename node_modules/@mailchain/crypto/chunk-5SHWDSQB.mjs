import {
  KindED25519
} from "./chunk-6E4UZ7KY.mjs";
import {
  __publicField
} from "./chunk-NHABU752.mjs";

// src/ed25519/public.ts
import nacl from "tweetnacl";
var ED25519PublicKeyLen = 32;
var ED25519PublicKey = class {
  constructor(bytes) {
    __publicField(this, "curve", KindED25519);
    __publicField(this, "bytes");
    if (bytes.length !== ED25519PublicKeyLen) {
      throw new RangeError("invalid public key length");
    }
    this.bytes = bytes;
  }
  async verify(message, sig) {
    return nacl.sign.detached.verify(message, sig, this.bytes);
  }
};
function asED25519PublicKey(key) {
  if (key.constructor !== ED25519PublicKey) {
    throw new Error("key must be ed25519");
  }
  return key;
}

export {
  ED25519PublicKeyLen,
  ED25519PublicKey,
  asED25519PublicKey
};
