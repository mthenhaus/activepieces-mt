"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var _chunkCC5XV3ZFjs = require('./chunk-CC5XV3ZF.js');


var _chunkUGHWWL7Yjs = require('./chunk-UGHWWL7Y.js');


var _chunkKJIHFHPMjs = require('./chunk-KJIHFHPM.js');


var _chunk76M6HHBQjs = require('./chunk-76M6HHBQ.js');


var _chunkFKBKPFXUjs = require('./chunk-FKBKPFXU.js');


var _chunkEMN3YRZAjs = require('./chunk-EMN3YRZA.js');


var _chunkXXPGZHWZjs = require('./chunk-XXPGZHWZ.js');

// src/cipher/nacl/privateKeyEncrypter.ts
var _ed2curve = require('ed2curve'); var _ed2curve2 = _interopRequireDefault(_ed2curve);
var PrivateKeyEncrypter = class {
  constructor(privateKey, rand = _chunkEMN3YRZAjs.secureRandom) {
    _chunkXXPGZHWZjs.__publicField.call(void 0, this, "_rand");
    _chunkXXPGZHWZjs.__publicField.call(void 0, this, "_secretKey");
    _chunkXXPGZHWZjs.__publicField.call(void 0, this, "_keyId");
    this._rand = rand;
    this._keyId = _chunkKJIHFHPMjs.idFromPrivateKey.call(void 0, privateKey);
    switch (privateKey.constructor) {
      case _chunkFKBKPFXUjs.ED25519PrivateKey:
        this._secretKey = _ed2curve2.default.convertSecretKey(privateKey.bytes);
        break;
      case _chunk76M6HHBQjs.SECP256K1PrivateKey:
        this._secretKey = privateKey.bytes;
        break;
      default:
        throw RangeError("unknown private key type");
    }
  }
  static fromPrivateKey(key, rand = _chunkEMN3YRZAjs.secureRandom) {
    return new this(key, rand);
  }
  async encrypt(input) {
    const sealedBox = _chunkCC5XV3ZFjs.easySeal.call(void 0, input, this._secretKey, this._rand);
    return _chunkUGHWWL7Yjs.serializePrivateKeyEncryptedContent.call(void 0, sealedBox, this._keyId);
  }
};



exports.PrivateKeyEncrypter = PrivateKeyEncrypter;
