"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var _chunkBSMIECIGjs = require('./chunk-BSMIECIG.js');


var _chunkXXPGZHWZjs = require('./chunk-XXPGZHWZ.js');

// src/ed25519/public.ts
var _tweetnacl = require('tweetnacl'); var _tweetnacl2 = _interopRequireDefault(_tweetnacl);
var ED25519PublicKeyLen = 32;
var ED25519PublicKey = class {
  constructor(bytes) {
    _chunkXXPGZHWZjs.__publicField.call(void 0, this, "curve", _chunkBSMIECIGjs.KindED25519);
    _chunkXXPGZHWZjs.__publicField.call(void 0, this, "bytes");
    if (bytes.length !== ED25519PublicKeyLen) {
      throw new RangeError("invalid public key length");
    }
    this.bytes = bytes;
  }
  async verify(message, sig) {
    return _tweetnacl2.default.sign.detached.verify(message, sig, this.bytes);
  }
};
function asED25519PublicKey(key) {
  if (key.constructor !== ED25519PublicKey) {
    throw new Error("key must be ed25519");
  }
  return key;
}





exports.ED25519PublicKeyLen = ED25519PublicKeyLen; exports.ED25519PublicKey = ED25519PublicKey; exports.asED25519PublicKey = asED25519PublicKey;
