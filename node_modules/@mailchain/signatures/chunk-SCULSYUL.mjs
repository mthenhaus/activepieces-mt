import {
  signRawEd25519,
  verifyRawEd25519
} from "./chunk-RNDAINMT.mjs";

// src/mailchain_password_reset.ts
var mailchainPasswordResetMessage = function(username, expires) {
  return Buffer.from(
    `Mailchain:
action: reset-password
expires: ${Math.floor(
      expires.getTime() / 1e3
    )}
username: ${username}`,
    "utf-8"
  );
};
async function signMailchainPasswordReset(signer, username, expires) {
  return signRawEd25519(signer, mailchainPasswordResetMessage(username, expires));
}
async function verifyMailchainPasswordReset(key, signature, username, expires) {
  return verifyRawEd25519(key, mailchainPasswordResetMessage(username, expires), signature);
}

export {
  mailchainPasswordResetMessage,
  signMailchainPasswordReset,
  verifyMailchainPasswordReset
};
